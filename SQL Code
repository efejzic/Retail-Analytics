Data Analysis

-- Gender and client count

WITH total AS (
    SELECT
        Gender,
        COUNT([Customer_ID]) AS client_count
    FROM
        [dbo].[shopping_trends_updated]
    GROUP BY
        Gender 
)

-- Male and female percentage

SELECT 
    SUM(CASE WHEN Gender = 'Male' THEN client_count ELSE 0 END) AS count_male,
    SUM(CASE WHEN Gender = 'Female' THEN client_count ELSE 0 END) AS count_female,
    (SUM(CASE WHEN Gender = 'Male' THEN client_count ELSE 0 END) * 100.0) /
        (SUM(CASE WHEN Gender = 'Male' THEN client_count ELSE 0 END) + SUM(CASE WHEN Gender = 'Female' THEN client_count ELSE 0 END)) AS pct_male,
    (SUM(CASE WHEN Gender = 'Female' THEN client_count ELSE 0 END) * 100.0) /
        (SUM(CASE WHEN Gender = 'Male' THEN client_count ELSE 0 END) + SUM(CASE WHEN Gender = 'Female' THEN client_count ELSE 0 END)) AS pct_female
FROM 
    total;
